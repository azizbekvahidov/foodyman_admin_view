"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[6124],{89281:function(e,t,n){n.d(t,{h:function(){return h}});var r=n(1413),i=n(29439),u=n(45987),s=n(47313),a=n(12279),l=n.n(a),o=n(74294),c=n(72652),d=n(46417),f=["fetchOptions","debounceTimeout"],h=function(e){var t=e.fetchOptions,n=e.debounceTimeout,a=void 0===n?400:n,h=(0,u.Z)(e,f),p=(0,s.useState)(!1),m=(0,i.Z)(p,2),Z=m[0],v=m[1],x=(0,s.useState)([]),j=(0,i.Z)(x,2),b=j[0],g=j[1],y=(0,s.useMemo)((function(){return l()((function(e){g([]),v(!0),t(e).then((function(e){g(e),v(!1)}))}),a)}),[t,a]);return(0,d.jsx)(o.Z,(0,r.Z)((0,r.Z)({showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:y,notFoundContent:Z?(0,d.jsx)(c.Z,{size:"small"}):"no results"},h),{},{options:b,onFocus:function(){b.length||y("")}}))}},16124:function(e,t,n){n.r(t);var r=n(4942),i=n(93433),u=n(1413),s=n(29439),a=n(47313),l=n(58467),o=n(34491),c=n(18197),d=n(77181),f=n(68197),h=n(59624),p=n(59491),m=n(2717),Z=n(90954),v=n(18333),x=n(89281),j=n(24511),b=n(4446),g=n(84980),y=n(51282),w=n(21249),S=n(46417);t.default=function(){var e,t,n=(0,j.$)().t,F=(0,m.v9)((function(e){return e.menu}),m.wU).activeMenu,_=(0,m.I0)(),O=c.Z.useForm(),k=(0,s.Z)(O,1)[0],N=(0,l.s0)(),I=(0,l.UO)().id,L=(0,m.v9)((function(e){return e.myShop}),m.wU).myShop,T=(0,a.useState)(null!==(e=F.data)&&void 0!==e&&e.images?[null===(t=F.data)||void 0===t?void 0:t.images[0]]:[]),U=(0,s.Z)(T,2),q=U[0],C=U[1],V=(0,a.useState)(!1),A=(0,s.Z)(V,2),R=A[0],M=A[1],D=(0,a.useState)(!1),E=(0,s.Z)(D,2),P=E[0],$=E[1];(0,a.useEffect)((function(){return function(){var e=k.getFieldsValue(!0);_((0,Z.nc)({activeMenu:F,data:e}))}}),[]);var z=function(e){return e.map((function(e){return{name:e,url:e}}))};return(0,a.useEffect)((function(){var e;F.refetch&&(e=I,$(!0),b.Z.getById(e).then((function(e){var t=e.data;k.setFieldsValue((0,u.Z)((0,u.Z)({},t),{},{image:z(t.file_urls),products:{label:t.product.translation.title,value:t.product.id}})),C(z(t.file_urls))})).finally((function(){$(!1),_((0,Z.A_)(F))})))}),[F.refetch]),(0,S.jsx)(d.Z,{title:n("edit.story"),className:"h-100",children:P?(0,S.jsx)(y.Z,{}):(0,S.jsxs)(c.Z,{name:"story-add",layout:"vertical",onFinish:function(e){var t=(0,u.Z)((0,u.Z)({},Object.assign.apply(Object,[{}].concat((0,i.Z)(q.map((function(e,t){return(0,r.Z)({},"file_urls[".concat(t,"]"),e.name)})))))),{},{product_id:e.products.value});M(!0);var s="seller/stories";b.Z.update(I,t).then((function(){var e={shop_id:L.id};o.Am.success(n("successfully.updated")),_((0,Z.ph)((0,u.Z)((0,u.Z)({},F),{},{nextUrl:s}))),N("/".concat(s)),_((0,g.U7)(e))})).finally((function(){return M(!1)}))},form:k,initialValues:(0,u.Z)({active:!0},F.data),className:"d-flex flex-column h-100",children:[(0,S.jsxs)(f.Z,{gutter:12,children:[(0,S.jsx)(h.Z,{span:24,children:(0,S.jsx)(c.Z.Item,{label:n("image"),name:"image",rules:[{required:q.length<0,message:n("required")}],children:(0,S.jsx)(w.Z,{form:k,setFileList:C,fileList:q})})}),(0,S.jsx)(h.Z,{span:24,children:(0,S.jsx)(c.Z.Item,{label:n("products"),name:"products",rules:[{required:!0,message:n("required")}],children:(0,S.jsx)(x.h,{fetchOptions:function(e){var t={search:e,shop_id:L.id,status:"published",active:1,rest:1};return v.Z.getAll(t).then((function(e){return e.data.map((function(e){return{label:e.translation.title,value:e.id,key:e.id}}))}))},debounceTimeout:200})})})]}),(0,S.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,S.jsx)("div",{className:"pb-5",children:(0,S.jsx)(p.Z,{type:"primary",htmlType:"submit",loading:R,children:n("submit")})})})]})})}},21249:function(e,t,n){n.d(t,{Z:function(){return v}});var r=n(93433),i=n(74165),u=n(15861),s=n(29439),a=n(47313),l=n(72652),o=n(15178),c=n(84695),d=n(82138),f=n(24511),h=n(34344),p={upload:function(e){return h.Z.post("dashboard/seller/stories/upload",e)}},m=n(46417),Z=function(e){return new Promise((function(t,n){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){return t(r.result)},r.onerror=function(e){return n(e)}}))},v=function(e){var t=e.fileList,n=e.setFileList,h=e.form,v=(0,f.$)().t,x=(0,a.useState)(!1),j=(0,s.Z)(x,2),b=j[0],g=j[1],y=(0,a.useState)(""),w=(0,s.Z)(y,2),S=w[0],F=w[1],_=(0,a.useState)(""),O=(0,s.Z)(_,2),k=O[0],N=O[1],I=(0,a.useState)(!1),L=(0,s.Z)(I,2),T=L[0],U=L[1],q=function(){var e=(0,u.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,Z(t.originFileObj);case 3:t.preview=e.sent;case 4:F(t.url||t.preview),g(!0),N(t.name||t.url.substring(t.url.lastIndexOf("/")+1));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(e){return{uid:e[0],name:e[0],status:"done",url:e[0],created:!0}},V=T?(0,m.jsx)("div",{children:(0,m.jsx)(l.Z,{})}):(0,m.jsxs)("div",{children:[(0,m.jsx)(d.Z,{className:"upload_plus"}),(0,m.jsx)("div",{style:{marginTop:8},children:(0,m.jsx)("span",{className:"upload_text",children:v("upload")})})]});return(0,m.jsxs)("div",{className:"story_img",children:[(0,m.jsx)(o.Z,{listType:"picture-card",fileList:t,onPreview:q,customRequest:function(e){var i=e.file,u=e.onSuccess;U(!0);var s=new FormData;s.append("files[0]",i),p.upload(s).then((function(e){var i=e.data;n((function(e){return[].concat((0,r.Z)(e),[C(i)])})),h.setFieldsValue({images:[].concat((0,r.Z)(t),[C(i)])}),u("ok")})).finally((function(){U(!1)}))},onRemove:function(e){n((function(t){return t.filter((function(t){return t.uid!==e.uid}))}))},children:t.length>=24?null:V}),(0,m.jsx)(c.Z,{visible:b,title:k,footer:null,onCancel:function(){return g(!1)},children:(0,m.jsx)("img",{alt:"example",style:{width:"100%"},src:S})})]})}}}]);