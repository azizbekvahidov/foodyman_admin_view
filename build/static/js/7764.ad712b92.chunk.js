"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[7764],{89281:function(e,t,n){n.d(t,{h:function(){return f}});var r=n(1413),a=n(29439),s=n(45987),i=n(47313),u=n(12279),l=n.n(u),d=n(74294),c=n(72652),o=n(46417),m=["fetchOptions","debounceTimeout"],f=function(e){var t=e.fetchOptions,n=e.debounceTimeout,u=void 0===n?400:n,f=(0,s.Z)(e,m),p=(0,i.useState)(!1),h=(0,a.Z)(p,2),Z=h[0],v=h[1],x=(0,i.useState)([]),j=(0,a.Z)(x,2),g=j[0],b=j[1],y=(0,i.useMemo)((function(){return l()((function(e){b([]),v(!0),t(e).then((function(e){b(e),v(!1)}))}),u)}),[t,u]);return(0,o.jsx)(d.Z,(0,r.Z)((0,r.Z)({showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:y,notFoundContent:Z?(0,o.jsx)(c.Z,{size:"small"}):"no results"},f),{},{options:g,onFocus:function(){g.length||y("")}}))}},57764:function(e,t,n){n.r(t),n.d(t,{default:function(){return O}});var r=n(74165),a=n(15861),s=n(1413),i=n(29439),u=n(47313),l=n(58467),d=n(34491),c=n(18197),o=n(77181),m=n(68197),f=n(59624),p=n(74294),h=n(6289),Z=n(99096),v=n(59491),x=n(70816),j=n.n(x),g=n(2717),b=n(90954),y=n(57409),Y=n(69660),M=n(89281),D=n(18333),q=n(24511),w=n(8550),S=n(5764),I=n(51282),N=n(46417);function O(){var e,t,n=(0,q.$)().t,x=(0,g.v9)((function(e){return e.menu}),g.wU).activeMenu,O=(0,g.I0)(),k=(0,l.UO)().id,F=c.Z.useForm(),C=(0,i.Z)(F,1)[0],U=(0,l.s0)(),V=(0,u.useState)(!1),_=(0,i.Z)(V,2),A=_[0],T=_[1],E=(0,u.useState)(!1),J=(0,i.Z)(E,2),L=J[0],z=J[1],B=(0,g.v9)((function(e){return e.myShop}),g.wU).myShop,$=(0,u.useState)(null!==(e=x.data)&&void 0!==e&&e.images?[null===(t=x.data)||void 0===t?void 0:t.images[0]]:[]),G=(0,i.Z)($,2),H=G[0],K=G[1];(0,u.useEffect)((function(){return function(){var e=C.getFieldsValue(!0),t=JSON.stringify(e.start),n=JSON.stringify(e.end),r=(0,s.Z)((0,s.Z)({},e),{},{start:t,end:n});O((0,b.nc)({activeMenu:x,data:r}))}}),[]),(0,u.useEffect)((function(){x.refetch&&(z(!0),y.Z.getById(k).then((function(e){var t=e.data,n={price:t.price,type:t.type,products:t.products.map((function(e){var t;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id}})),start:j()(t.start,"YYYY-MM-DD"),end:j()(t.end,"YYYY-MM-DD"),image:[(0,w.Z)(t.img)]};C.setFieldsValue(n),K([(0,w.Z)(t.img)])})).finally((function(){z(!1),O((0,b.A_)(x))})))}),[x.refetch]);function P(){return(P=(0,a.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={search:t,shop_id:B.id,status:"published",active:1,rest:1},e.abrupt("return",D.Z.getAll(n).then((function(e){return e.data.map((function(e){var t;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id}}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,N.jsx)(o.Z,{title:n("edit.discount"),className:"h-100",children:L?(0,N.jsx)(I.Z,{}):(0,N.jsxs)(c.Z,{name:"discount-add",layout:"vertical",onFinish:function(e){var t,r={price:e.price,type:e.type,products:e.products.map((function(e){return e.value})),start:e.start?j()(e.start).format("YYYY-MM-DD"):void 0,end:e.end?j()(e.end).format("YYYY-MM-DD"):void 0,images:[null===(t=H[0])||void 0===t?void 0:t.name]};T(!0);var a="seller/discounts";y.Z.update(k,r).then((function(){d.Am.success(n("successfully.updated")),O((0,b.ph)((0,s.Z)((0,s.Z)({},x),{},{nextUrl:a}))),U("/".concat(a)),O((0,Y.k)({}))})).finally((function(){return T(!1)}))},form:C,initialValues:(0,s.Z)({},function(){var e,t=x.data;if(null===(e=x.data)||void 0===e||!e.start)return t;var n=x.data.start,r=x.data.end;return(0,s.Z)((0,s.Z)({},t),{},{start:j()(n,"YYYY-MM-DD"),end:j()(r,"YYYY-MM-DD")})}()),className:"d-flex flex-column h-100",children:[(0,N.jsxs)(m.Z,{gutter:12,children:[(0,N.jsx)(f.Z,{span:12,children:(0,N.jsx)(c.Z.Item,{label:n("type"),name:"type",rules:[{required:!0,message:n("required")}],children:(0,N.jsxs)(p.Z,{children:[(0,N.jsx)(p.Z.Option,{value:"fix",children:n("fix")}),(0,N.jsx)(p.Z.Option,{value:"percent",children:n("percent")})]})})}),(0,N.jsx)(f.Z,{span:12,children:(0,N.jsx)(c.Z.Item,{label:n("price"),name:"price",rules:[{required:!0,message:n("required")}],children:(0,N.jsx)(h.Z,{min:0,className:"w-100"})})}),(0,N.jsx)(f.Z,{span:12,children:(0,N.jsx)(c.Z.Item,{label:n("start.date"),name:"start",rules:[{required:!0,message:n("required")}],children:(0,N.jsx)(Z.Z,{className:"w-100",placeholder:"",disabledDate:function(e){return j()().add(-1,"days")>=e}})})}),(0,N.jsx)(f.Z,{span:12,children:(0,N.jsx)(c.Z.Item,{label:n("end.date"),name:"end",rules:[{required:!0,message:n("required")}],children:(0,N.jsx)(Z.Z,{className:"w-100",placeholder:"",disabledDate:function(e){return j()().add(-1,"days")>=e}})})}),(0,N.jsx)(f.Z,{span:24,children:(0,N.jsx)(c.Z.Item,{label:n("products"),name:"products",rules:[{required:!0,message:n("required")}],children:(0,N.jsx)(M.h,{fetchOptions:function(e){return P.apply(this,arguments)},mode:"multiple"})})}),(0,N.jsx)(f.Z,{span:24,children:(0,N.jsx)(c.Z.Item,{label:n("image"),name:"image",rules:[{required:!H.length,message:n("required")}],children:(0,N.jsx)(S.Z,{type:"discounts",imageList:H,setImageList:K,form:C,multiple:!1,name:"image"})})})]}),(0,N.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,N.jsx)("div",{className:"pb-5",children:(0,N.jsx)(v.Z,{type:"primary",htmlType:"submit",loading:A,children:n("submit")})})})]})})}}}]);