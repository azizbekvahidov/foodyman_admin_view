"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[8531],{13976:function(e,n,r){r.d(n,{Z:function(){return V}});var a=r(1413),t=r(29439),s=r(47313),i=r(18197),l=r(45705),o=r(59491),u=r(58467),d=r(74165),c=r(4942),m=r(15861),p=r(68197),Z=r(59624),h=r(77181),f=r(66672),x=r(86345),j=r(6289),g=r(46155),v=r(74294),b=r(52421),y=r(49986),w=r(2717),_=r(24511),q=r(30763),I=r(97388),k=r(75049),S=r(5764),F=r(98447),N=r(84695),L=r(34491),C=r(46417);function O(e){var n=e.visible,r=e.handleCancel,a=(0,_.$)().t,l=i.Z.useForm(),u=(0,t.Z)(l,1)[0],d=(0,s.useState)(!1),c=(0,t.Z)(d,2),m=c[0],h=c[1],x=(0,s.useState)(null),g=(0,t.Z)(x,2),v=g[0],b=g[1];return(0,C.jsx)(N.Z,{title:a("add.client"),visible:n,onCancel:r,footer:[(0,C.jsx)(o.Z,{type:"primary",onClick:function(){return u.submit()},loading:m,children:a("save")},"ok-button"),(0,C.jsx)(o.Z,{onClick:r,children:a("cancel")},"cancel-button")],children:(0,C.jsx)(i.Z,{layout:"vertical",name:"user-add-form",form:u,onFinish:function(e){var n={firstname:e.firstname,lastname:e.lastname,email:e.email,phone:e.phone,password_confirmation:e.password_confirmation,password:e.password,role:"user"};h(!0),y.Z.create(n).then((function(){L.Am.success(a("successfully.added")),r()})).catch((function(e){return b(e.response.data.params)})).finally((function(){return h(!1)}))},children:(0,C.jsxs)(p.Z,{gutter:12,children:[(0,C.jsx)(Z.Z,{span:12,children:(0,C.jsx)(i.Z.Item,{label:a("firstname"),name:"firstname",help:null!==v&&void 0!==v&&v.firstname?v.firstname[0]:null,validateStatus:null!==v&&void 0!==v&&v.firstname?"error":"success",rules:[{required:!0,message:a("required")}],children:(0,C.jsx)(f.Z,{})})}),(0,C.jsx)(Z.Z,{span:12,children:(0,C.jsx)(i.Z.Item,{label:"lastname",name:"lastname",help:null!==v&&void 0!==v&&v.lastname?v.lastname[0]:null,validateStatus:null!==v&&void 0!==v&&v.lastname?"error":"success",rules:[{required:!0,message:a("required")}],children:(0,C.jsx)(f.Z,{})})}),(0,C.jsx)(Z.Z,{span:12,children:(0,C.jsx)(i.Z.Item,{label:a("phone"),name:"phone",help:null!==v&&void 0!==v&&v.phone?v.phone[0]:null,validateStatus:null!==v&&void 0!==v&&v.phone?"error":"success",rules:[{required:!0,message:a("required")}],children:(0,C.jsx)(j.Z,{min:0,className:"w-100"})})}),(0,C.jsx)(Z.Z,{span:12,children:(0,C.jsx)(i.Z.Item,{label:a("email"),name:"email",help:null!==v&&void 0!==v&&v.email?v.email[0]:null,validateStatus:null!==v&&void 0!==v&&v.email?"error":"success",rules:[{required:!0,message:a("required")}],children:(0,C.jsx)(f.Z,{type:"email"})})}),(0,C.jsx)(Z.Z,{span:12,children:(0,C.jsx)(i.Z.Item,{label:a("password"),name:"password",help:null!==v&&void 0!==v&&v.password?v.password[0]:null,validateStatus:null!==v&&void 0!==v&&v.password?"error":"success",rules:[{required:!0,message:a("required")}],children:(0,C.jsx)(f.Z.Password,{type:"password",className:"w-100"})})}),(0,C.jsx)(Z.Z,{span:12,children:(0,C.jsx)(i.Z.Item,{label:a("password.confirmation"),help:null!==v&&void 0!==v&&v.password_confirmation?v.password_confirmation[0]:null,validateStatus:null!==v&&void 0!==v&&v.password_confirmation?"error":"success",name:"password_confirmation",dependencies:["password"],hasFeedback:!0,rules:[{required:!0,message:a("required")},function(e){var n=e.getFieldValue;return{validator:function(e,r){return r&&n("password")!==r?Promise.reject(a("two.passwords.dont.match")):Promise.resolve()}}}],children:(0,C.jsx)(f.Z.Password,{type:"password"})})})]})})})}var H=r(45005),Y=r(13622),A=r(61197),D=function(e){var n=e.logoImage,r=e.setLogoImage,a=e.backImage,l=e.setBackImage,u=e.form,N=e.location,L=e.setLocation,D=e.user,M=(0,_.$)().t,P=(0,s.useState)(null),B=(0,t.Z)(P,2),V=B[0],R=B[1],U=(0,s.useState)(null),$=(0,t.Z)(U,2),E=$[0],J=$[1],T=(0,s.useState)(null),z=(0,t.Z)(T,2),G=z[0],K=z[1],Q=(0,w.v9)((function(e){return e.formLang}),w.wU),W=Q.defaultLang,X=Q.languages;function ee(){return(ee=(0,m.Z)((0,d.Z)().mark((function e(n){var r;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={search:n,roles:"user",empty_shop:1},K(!1),e.abrupt("return",y.Z.search(r).then((function(e){return e.data.map((function(e){return{label:e.firstname+" "+(e.lastname?e.lastname:""),value:e.id}}))})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(){return(ne=(0,m.Z)((0,d.Z)().mark((function e(n){var r;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={search:n,type:"shop"},K(!1),e.abrupt("return",q.Z.getAll(r).then((function(e){return e.data.map((function(e){var n;return{label:(null===(n=e.translation)||void 0===n?void 0:n.title)||"no name",value:e.id}}))})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(){return(re=(0,m.Z)((0,d.Z)().mark((function e(n){var r;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return K(!1),r={search:n},e.abrupt("return",A.Z.getAll(r).then((function(e){return e.data.map((function(e){var n;return{label:(null===(n=e.translation)||void 0===n?void 0:n.title)||"no name",value:e.id}}))})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ae=function(){R(!0),K(!0)},te=function(){J(!0),K(!0)},se=function(){R(!1),J(!1)};return(0,C.jsxs)(p.Z,{gutter:12,children:[(0,C.jsx)(Z.Z,{span:24,children:(0,C.jsx)(h.Z,{children:(0,C.jsxs)(p.Z,{gutter:12,children:[(0,C.jsx)(Z.Z,{span:4,children:(0,C.jsx)(i.Z.Item,{label:M("logo.image"),children:(0,C.jsx)(S.Z,{type:"shops/logo",imageList:n,setImageList:r,form:u,multiple:!1,name:"logo_img"})})}),(0,C.jsx)(Z.Z,{span:4,children:(0,C.jsx)(i.Z.Item,{label:M("background.image"),children:(0,C.jsx)(S.Z,{type:"shops/background",imageList:a,setImageList:l,form:u,multiple:!1,name:"background_img"})})}),(0,C.jsx)(Z.Z,{span:10,children:(0,C.jsx)(i.Z.Item,{label:M("status.note"),name:"status_note",children:(0,C.jsx)(b.Z,{rows:4})})}),(0,C.jsx)(Z.Z,{span:4,children:(0,C.jsx)(i.Z.Item,{name:"status",label:M("status"),children:(0,C.jsx)(f.Z,{disabled:!0})})}),(0,C.jsx)(Z.Z,{span:2,children:(0,C.jsx)(i.Z.Item,{label:M("open"),name:"open",valuePropName:"checked",children:(0,C.jsx)(x.Z,{disabled:!0})})})]})})}),(0,C.jsx)(Z.Z,{span:24,children:(0,C.jsx)(h.Z,{title:M("general"),children:(0,C.jsxs)(p.Z,{gutter:12,children:[(0,C.jsx)(Z.Z,{span:12,children:(0,C.jsxs)(p.Z,{gutter:12,children:[(0,C.jsx)(Z.Z,{span:24,children:X.map((function(e,n){return(0,C.jsx)(i.Z.Item,{label:M("title"),name:"title[".concat(e.locale,"]"),rules:[{required:e.locale===W,message:M("required")},{min:2,message:M("title.requared")}],hidden:e.locale!==W,children:(0,C.jsx)(f.Z,{})},"title"+n)}))}),(0,C.jsx)(Z.Z,{span:24,children:(0,C.jsx)(i.Z.Item,{label:M("phone"),name:"phone",rules:[{required:!0,message:M("required")}],children:(0,C.jsx)(j.Z,{min:0,className:"w-100"})})})]})}),(0,C.jsx)(Z.Z,{span:12,children:X.map((function(e,n){return(0,C.jsx)(i.Z.Item,{label:M("description"),name:"description[".concat(e.locale,"]"),rules:[{required:e.locale===W,message:M("required")},{min:3,message:M("requared")}],hidden:e.locale!==W,children:(0,C.jsx)(b.Z,{rows:4})},"desc"+n)}))}),(0,C.jsx)(Z.Z,{span:8,children:(0,C.jsx)(i.Z.Item,{label:M("restaurant.tags"),name:"tags",rules:[{required:!1,message:M("required")}],children:(0,C.jsx)(Y.R,{mode:"multiple",fetchOptions:function(e){return re.apply(this,arguments)},refetch:G})})}),(0,C.jsx)(Z.Z,{span:8,children:(0,C.jsx)(i.Z.Item,{label:M("seller"),name:"user",rules:[{required:!0,message:M("required")}],children:(0,C.jsx)(Y.R,{disabled:D,fetchOptions:function(e){return ee.apply(this,arguments)},refetch:G,dropdownRender:function(e){return(0,C.jsxs)(C.Fragment,{children:[e,(0,C.jsx)(g.Z,{style:{margin:"8px 0"}}),(0,C.jsx)(o.Z,{className:"w-100",disabled:D,icon:(0,C.jsx)(F.Z,{}),onClick:ae,children:M("add.user")})]})}})})}),(0,C.jsx)(Z.Z,{span:8,children:(0,C.jsx)(i.Z.Item,{label:M("categories"),name:"categories",rules:[{required:!0,message:M("required")}],children:(0,C.jsx)(Y.R,{mode:"multiple",fetchOptions:function(e){return ne.apply(this,arguments)},refetch:G,dropdownRender:function(e){return(0,C.jsxs)(C.Fragment,{children:[e,(0,C.jsx)(g.Z,{style:{margin:"8px 0"}}),(0,C.jsx)(o.Z,{className:"w-100",icon:(0,C.jsx)(F.Z,{}),onClick:te,children:M("add.category")})]})}})})})]})})}),(0,C.jsx)(Z.Z,{span:8,children:(0,C.jsx)(h.Z,{title:M("delivery"),children:(0,C.jsxs)(p.Z,{gutter:8,children:[(0,C.jsx)(Z.Z,{span:12,children:(0,C.jsx)(i.Z.Item,{name:"price",label:M("min.price"),rules:[{required:!0,message:M("required")}],children:(0,C.jsx)(j.Z,{className:"w-100"})})}),(0,C.jsx)(Z.Z,{span:12,children:(0,C.jsx)(i.Z.Item,{name:"price_per_km",label:M("price.per.km"),rules:[{required:!0,message:M("required")}],children:(0,C.jsx)(j.Z,{className:"w-100"})})})]})})}),(0,C.jsx)(Z.Z,{span:8,children:(0,C.jsx)(h.Z,{title:M("delivery.time"),children:(0,C.jsxs)(p.Z,{gutter:12,children:[(0,C.jsx)(Z.Z,{span:12,children:(0,C.jsx)(i.Z.Item,{name:"delivery_time_type",label:M("delivery_time_type"),rules:[{required:!0,message:M("required")}],children:(0,C.jsxs)(v.Z,{className:"w-100",children:[(0,C.jsx)(v.Z.Option,{value:"minute",label:M("minutes")}),(0,C.jsx)(v.Z.Option,{value:"hour",label:M("hour")})]})})}),(0,C.jsx)(Z.Z,{span:12,children:(0,C.jsx)(i.Z.Item,{name:"delivery_time_from",label:M("delivery_time_from"),rules:[{required:!0,message:M("required")}],children:(0,C.jsx)(j.Z,{className:"w-100"})})}),(0,C.jsx)(Z.Z,{span:12,children:(0,C.jsx)(i.Z.Item,{name:"delivery_time_to",label:M("delivery_time_to"),rules:[{required:!0,message:M("required")}],children:(0,C.jsx)(j.Z,{className:"w-100"})})})]})})}),(0,C.jsx)(Z.Z,{span:8,children:(0,C.jsx)(h.Z,{title:M("order.info"),children:(0,C.jsxs)(p.Z,{gutter:12,children:[(0,C.jsx)(Z.Z,{span:12,children:(0,C.jsx)(i.Z.Item,{label:M("min.amount"),name:"min_amount",rules:[{required:!0,message:M("required")}],children:(0,C.jsx)(j.Z,{min:0,className:"w-100"})})}),(0,C.jsx)(Z.Z,{span:12,children:(0,C.jsx)(i.Z.Item,{label:M("tax"),name:"tax",rules:[{required:!0,message:M("required")}],children:(0,C.jsx)(j.Z,{min:0,addonAfter:"%",className:"w-100"})})}),(0,C.jsx)(Z.Z,{span:12,children:(0,C.jsx)(i.Z.Item,{label:M("admin.comission"),name:"percentage",rules:[{required:!0,message:M("required")}],children:(0,C.jsx)(j.Z,{min:0,className:"w-100",addonAfter:"%"})})})]})})}),(0,C.jsx)(Z.Z,{span:24,children:(0,C.jsx)(h.Z,{title:M("address"),children:(0,C.jsxs)(p.Z,{gutter:12,children:[(0,C.jsx)(Z.Z,{span:12,children:X.map((function(e,n){return(0,C.jsx)(k.Z,{setLocation:L,form:u,item:e,idx:n,defaultLang:W},n)}))}),(0,C.jsx)(Z.Z,{span:24,children:(0,C.jsx)(I.Z,{location:N,setLocation:L,setAddress:function(e){return u.setFieldsValue((0,c.Z)({},"address[".concat(W,"]"),e))}})})]})})}),V&&(0,C.jsx)(O,{visible:V,handleCancel:function(){return se()}}),E&&(0,C.jsx)(H.Z,{visible:E,handleCancel:function(){return se()}})]})},M=r(90954),P=r(53149),B=r(17649),V=function(e){var n,r,d,c,m,p,Z,h,f,x=e.next,j=e.action_type,g=void 0===j?"":j,v=e.user,b=(0,_.$)().t,y=i.Z.useForm(),q=(0,t.Z)(y,1)[0],I=(0,u.s0)(),k=(0,w.I0)(),S=(0,u.UO)().uuid,F=(0,w.v9)((function(e){return e.menu}),w.wU).activeMenu,N=(0,s.useState)(!1),L=(0,t.Z)(N,2),O=L[0],H=L[1],Y=(0,s.useState)(null!==(n=F.data)&&void 0!==n&&n.logo_img?[null===(r=F.data)||void 0===r?void 0:r.logo_img]:[]),A=(0,t.Z)(Y,2),V=A[0],R=A[1],U=(0,s.useState)(null!==(d=F.data)&&void 0!==d&&d.background_img?[null===(c=F.data)||void 0===c?void 0:c.background_img]:[]),$=(0,t.Z)(U,2),E=$[0],J=$[1],T=(0,w.v9)((function(e){return e.globalSettings}),w.wU).settings,z=(0,s.useState)(null!==F&&void 0!==F&&null!==(m=F.data)&&void 0!==m&&m.location?{lat:parseFloat(null===F||void 0===F||null===(p=F.data)||void 0===p||null===(Z=p.location)||void 0===Z?void 0:Z.latitude),lng:parseFloat(null===F||void 0===F||null===(h=F.data)||void 0===h||null===(f=h.location)||void 0===f?void 0:f.longitude)}:(0,B.Z)(T)),G=(0,t.Z)(z,2),K=G[0],Q=G[1];(0,s.useEffect)((function(){return function(){var e=q.getFieldsValue(!0);e.open_time=JSON.stringify(null===e||void 0===e?void 0:e.open_time),e.close_time=JSON.stringify(null===e||void 0===e?void 0:e.close_time),k((0,M.nc)({activeMenu:F,data:(0,a.Z)((0,a.Z)({},F.data),e)}))}}),[]);return(0,C.jsx)(C.Fragment,{children:(0,C.jsxs)(i.Z,{form:q,name:"basic",layout:"vertical",onFinish:function(e){var n,r,t;H(!0);var s=(0,a.Z)((0,a.Z)({},e),{},{"images[0]":null===(n=V[0])||void 0===n?void 0:n.name,"images[1]":null===(r=E[0])||void 0===r?void 0:r.name,delivery_time_type:e.delivery_time_type,delivery_time_to:e.delivery_time_to,delivery_time_from:e.delivery_time_from,categories:e.categories.map((function(e){return e.value})),tags:null===e||void 0===e||null===(t=e.tags)||void 0===t?void 0:t.map((function(e){return e.value})),user_id:e.user.value,open:void 0,"location[latitude]":K.lat,"location[longitude]":K.lng,user:void 0,delivery_time:0,type:"restaurant"});"edit"===g?function(e,n){P.Z.update(S,n).then((function(){k((0,M.nc)({activeMenu:F,data:e})),x()})).catch((function(e){return console.error(e)})).finally((function(){return H(!1)}))}(e,s):function(e,n){P.Z.create(n).then((function(n){var r=n.data;k((0,M.SS)({id:"restaurant-".concat(r.uuid),url:"restaurant/".concat(r.uuid),name:b("add.restaurant"),data:(0,a.Z)((0,a.Z)({},r),{},{background_img:{name:null===r||void 0===r?void 0:r.background_img},logo_img:{name:null===r||void 0===r?void 0:r.logo_img}},e),refetch:!1})),I("/restaurant/".concat(r.uuid,"?step=1"))})).catch((function(e){return console.error(e)})).finally((function(){return H(!1)}))}(e,s)},initialValues:(0,a.Z)({open:!1,status:"new"},F.data),children:[(0,C.jsx)(D,{logoImage:V,setLogoImage:R,backImage:E,setBackImage:J,form:q,location:K,setLocation:Q,user:v}),(0,C.jsx)(l.Z,{children:(0,C.jsx)(o.Z,{type:"primary",htmlType:"submit",loading:O,children:b("next")})})]})})}},48662:function(e,n,r){var a=r(29439),t=r(18197),s=r(47313),i=r(51282),l=r(70816),o=r.n(l),u=r(78790),d=r(49682),c=r(58467),m=r(21429),p=r(22899),Z=r(46417);n.Z=function(e){var n=e.next,r=e.prev,l=t.Z.useForm(),h=(0,a.Z)(l,1)[0],f=(0,s.useState)([]),x=(0,a.Z)(f,2),j=x[0],g=x[1],v=(0,s.useState)(new Array(7).fill(!1)),b=(0,a.Z)(v,2),y=b[0],w=b[1],_=(0,s.useState)(!1),q=(0,a.Z)(_,2),I=q[0],k=q[1],S=(0,s.useState)(!1),F=(0,a.Z)(S,2),N=F[0],L=F[1],C=(0,c.UO)().uuid;return(0,s.useEffect)((function(){h.setFieldsValue({working_days:m.P}),C&&(L(!0),d.Z.getById(C).then((function(e){g(e.data.closed_dates.filter((function(e){return e.day>o()(new Date).format("YYYY-MM-DD")})).map((function(e){return new Date(e.day)})))})),u.Z.getById(C).then((function(e){w(0!==e.data.dates.length?e.data.dates.map((function(e){return e.disabled})):[]),0!==e.data.dates.length&&h.setFieldsValue({working_days:e.data.dates.map((function(e){return{title:e.day,from:o()(e.from,"HH:mm:ss"),to:o()(e.to,"HH:mm:ss"),disabled:Boolean(e.disabled)}}))})})).finally((function(){return L(!1)})))}),[]),(0,Z.jsx)(Z.Fragment,{children:N?(0,Z.jsx)(i.Z,{}):(0,Z.jsx)(p.Z,{onFinish:function(e){k(!0);var r={dates:j?j.map((function(e){return o()(e).format("YYYY-MM-DD")})):void 0},a={dates:e.working_days.map((function(e){return{day:e.title,from:o()(e.from?e.from:"00").format("HH-mm"),to:o()(e.to?e.to:"00").format("HH-mm"),disabled:e.disabled}}))};d.Z.update(C,r).then((function(){n()})).finally((function(){return k(!1)})),0!==e.working_days.length&&u.Z.update(C,a).then((function(){n()})).finally((function(){return k(!1)}))},prev:r,form:h,lines:y,loadingBtn:I,days:j,setDays:g,setLines:w,weeks:m.P})})}}}]);