"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[9555],{29555:function(t,e,n){n.r(e);var i=n(93433),a=n(4942),c=n(1413),l=n(29439),r=n(47313),s=n(58467),u=n(34491),o=n(83999),d=n(18197),p=n(77181),f=n(72652),g=n(97421),v=n(2717),Z=n(90954),h=n(24511),m=n(73431),b=n(10596),y=n(12545),j=n(46417),_=o.Z.Step;e.default=function(){var t,e,n,k=(0,h.$)().t,x=(0,v.v9)((function(t){return t.menu}),v.wU).activeMenu,S=(0,s.UO)().id,w=(0,v.I0)(),O=(0,v.v9)((function(t){return t.formLang}),v.wU).defaultLang,F=(0,r.useState)((null===(t=x.data)||void 0===t?void 0:t.step)||0),U=(0,l.Z)(F,2),V=U[0],I=U[1],M=function(t){return{name:t,url:g.bV+t}},N=(0,r.useState)(null!==(e=x.data)&&void 0!==e&&e.galleries[0]?[M(x.data.galleries[0].path)]:[]),q=(0,l.Z)(N,2),A=q[0],B=q[1],C=(0,r.useState)(null!==(n=x.data)&&void 0!==n&&n.galleries[1]?[M(x.data.galleries[1].path)]:[]),E=(0,l.Z)(C,2),L=E[0],z=E[1],$=function(){I(V+1)},D=function(){I(V-1)},G=d.Z.useForm(),H=(0,l.Z)(G,1)[0],J=(0,s.s0)(),K=(0,r.useState)(!1),P=(0,l.Z)(K,2),Q=P[0],R=P[1],T=(0,r.useState)(!1),W=(0,l.Z)(T,2),X=W[0],Y=W[1];(0,r.useEffect)((function(){return function(){var t=H.getFieldsValue(!0);w((0,Z.nc)({activeMenu:x,data:t}))}}),[]);var tt=[].concat((0,i.Z)(A),(0,i.Z)(L));return(0,r.useEffect)((function(){x.refetch&&function(t){R(!0),y.Z.getById(t).then((function(t){var e,n,l,r=t.data;H.setFieldsValue((0,c.Z)((0,c.Z)({},r),{},{title:(0,a.Z)({},O,r.translation.title),description:(0,a.Z)({},O,r.translation.description),instruction:Object.assign.apply(Object,[{}].concat((0,i.Z)(r.instructions.map((function(t){return(0,a.Z)({},t.locale,t.title)}))))),ingredient:Object.assign.apply(Object,[{}].concat((0,i.Z)(r.ingredients.map((function(t){return(0,a.Z)({},t.locale,t.title)}))))),nutrition:null===(e=r.nutritions)||void 0===e?void 0:e.map((function(t){return(0,c.Z)({percentage:t.percentage.toString(),weight:t.weight},Object.assign.apply(Object,[{}].concat((0,i.Z)(t.translations.flatMap((function(t){return(0,a.Z)({},t.locale,t.title)}))))))})),category_id:{value:r.category.id,label:null===(n=r.category.translation)||void 0===n?void 0:n.title},shop_id:{value:r.shop.id,label:null===(l=r.shop.translation)||void 0===l?void 0:l.title},stocks:r.stocks.map((function(t){return(0,c.Z)({stock_id:{value:t.id,label:t.product.translation.title}},t)}))})),B([M(r.galleries[0].path)]),z([M(r.galleries[1].path)])})).finally((function(){R(!1),w((0,Z.A_)(x))}))}(S)}),[x.refetch]),(0,j.jsx)(p.Z,{title:k("edit.recepe"),extra:(0,j.jsx)(m.Z,{}),children:Q?(0,j.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,j.jsx)(f.Z,{size:"large",className:"py-5"})}):(0,j.jsxs)(d.Z,{layout:"vertical",onFinish:function(t){var e;H.validateFields();var n=(0,c.Z)((0,c.Z)({},t),{},{category_id:t.category_id.value,images:tt.map((function(t){return t.name})),shop_id:t.shop_id.value,nutrition:t.nutrition.map((function(t){return(0,c.Z)((0,c.Z)({},t),{},{percentage:String(t.percentage),weight:String(t.weight)})})),stocks:null===(e=t.stocks)||void 0===e?void 0:e.map((function(t){return{min_quantity:t.min_quantity,stock_id:t.stock_id.value}}))});Y(!0);var i="catalog/recept";y.Z.update(S,n).then((function(){u.Am.success(k("successfully.updated")),J("/".concat(i)),w((0,Z.ph)((0,c.Z)((0,c.Z)({},x),{},{nextUrl:i})))})).finally((function(){return Y(!1)}))},form:H,initialValues:(0,c.Z)({active:!0},x.data),children:[(0,j.jsx)(o.Z,{current:V,children:b.S.map((function(t){return(0,j.jsx)(_,{title:k(t.title)},t.title)}))}),b.S.map((function(t){var e=t.content;return(0,j.jsx)("div",{className:"steps-content ".concat(t.step!==V+1&&"hidden"),children:(0,j.jsx)(e,{next:$,prev:D,loading:X,image:A,setImage:B,back:L,setBack:z})},t.title)}))]})})}}}]);