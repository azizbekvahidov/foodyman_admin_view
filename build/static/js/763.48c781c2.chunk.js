"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[763],{75049:function(e,n,t){t.d(n,{Z:function(){return u}});var r=t(4942),a=t(18197),i=(t(47313),t(47168)),s=t(24511),l=t(2717),d=t(97421),o=t(46417);function u(e){var n=e.setLocation,t=e.form,u=e.item,c=e.idx,m=e.defaultLang,Z=(0,s.$)().t,h=(0,l.v9)((function(e){return e.globalSettings.settings}),l.wU).google_map_key,p=(0,i.usePlacesWidget)({apiKey:h||d.kr,onPlaceSelected:function(e){var a={lat:null===e||void 0===e?void 0:e.geometry.location.lat(),lng:null===e||void 0===e?void 0:e.geometry.location.lng()};n(a),t.setFieldsValue((0,r.Z)({},"address[".concat(m,"]"),null===e||void 0===e?void 0:e.formatted_address))}}).ref;return(0,o.jsx)(a.Z.Item,{label:Z("address"),name:"address[".concat(null===u||void 0===u?void 0:u.locale,"]"),rules:[{required:(null===u||void 0===u?void 0:u.locale)===m,message:Z("required")}],hidden:(null===u||void 0===u?void 0:u.locale)!==m,children:(0,o.jsx)("input",{className:"address-input",ref:p,placeholder:""})},"address"+c)}},80812:function(e,n,t){t.d(n,{Z:function(){return C}});var r=t(1413),a=t(29439),i=t(47313),s=t(18197),l=t(45705),d=t(59491),o=t(58467),u=t(74165),c=t(4942),m=t(15861),Z=t(68197),h=t(59624),p=t(77181),f=t(66672),g=t(86345),x=t(6289),v=t(46155),j=t(74294),y=t(52421),b=t(49986),_=t(2717),w=t(24511),I=t(30763),q=t(97388),k=t(75049),S=t(5764),L=t(98447),F=t(74551),N=t(45005),O=t(13622),H=t(61197),Y=t(46417),D=function(e){var n=e.logoImage,t=e.setLogoImage,r=e.backImage,l=e.setBackImage,o=e.form,D=e.location,M=e.setLocation,A=e.user,B=(0,w.$)().t,C=(0,i.useState)(null),U=(0,a.Z)(C,2),V=U[0],P=U[1],R=(0,i.useState)(null),$=(0,a.Z)(R,2),E=$[0],J=$[1],K=(0,i.useState)(null),T=(0,a.Z)(K,2),W=T[0],z=T[1],G=(0,_.v9)((function(e){return e.formLang}),_.wU),Q=G.defaultLang,X=G.languages;function ee(){return(ee=(0,m.Z)((0,u.Z)().mark((function e(n){var t;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={search:n,roles:"user","empty-shop":1},z(!1),e.abrupt("return",b.Z.search(t).then((function(e){return e.data.map((function(e){return{label:e.firstname+" "+(e.lastname?e.lastname:""),value:e.id}}))})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(){return(ne=(0,m.Z)((0,u.Z)().mark((function e(n){var t;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={search:n,type:"shop"},z(!1),e.abrupt("return",I.Z.getAll(t).then((function(e){return e.data.map((function(e){var n;return{label:(null===(n=e.translation)||void 0===n?void 0:n.title)||"no name",value:e.id}}))})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(){return(te=(0,m.Z)((0,u.Z)().mark((function e(n){var t;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return z(!1),t={search:n},e.abrupt("return",H.Z.getAll(t).then((function(e){return e.data.map((function(e){var n;return{label:(null===(n=e.translation)||void 0===n?void 0:n.title)||"no name",value:e.id}}))})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var re=function(){P(!0),z(!0)},ae=function(){J(!0),z(!0)},ie=function(){P(!1),J(!1)};return(0,Y.jsxs)(Z.Z,{gutter:12,children:[(0,Y.jsx)(h.Z,{span:24,children:(0,Y.jsx)(p.Z,{children:(0,Y.jsxs)(Z.Z,{gutter:12,children:[(0,Y.jsx)(h.Z,{span:4,children:(0,Y.jsx)(s.Z.Item,{label:B("logo.image"),children:(0,Y.jsx)(S.Z,{type:"shops/logo",imageList:n,setImageList:t,form:o,multiple:!1,name:"logo_img"})})}),(0,Y.jsx)(h.Z,{span:4,children:(0,Y.jsx)(s.Z.Item,{label:B("background.image"),children:(0,Y.jsx)(S.Z,{type:"shops/background",imageList:r,setImageList:l,form:o,multiple:!1,name:"background_img"})})}),(0,Y.jsx)(h.Z,{span:10,children:(0,Y.jsx)(s.Z.Item,{label:B("status.note"),name:"status_note",children:(0,Y.jsx)(y.Z,{rows:4})})}),(0,Y.jsx)(h.Z,{span:4,children:(0,Y.jsx)(s.Z.Item,{name:"status",label:B("status"),children:(0,Y.jsx)(f.Z,{disabled:!0})})}),(0,Y.jsx)(h.Z,{span:2,children:(0,Y.jsx)(s.Z.Item,{label:B("open"),name:"open",valuePropName:"checked",children:(0,Y.jsx)(g.Z,{disabled:!0})})})]})})}),(0,Y.jsx)(h.Z,{span:24,children:(0,Y.jsx)(p.Z,{title:B("general"),children:(0,Y.jsxs)(Z.Z,{gutter:12,children:[(0,Y.jsx)(h.Z,{span:12,children:(0,Y.jsxs)(Z.Z,{gutter:12,children:[(0,Y.jsx)(h.Z,{span:24,children:X.map((function(e,n){return(0,Y.jsx)(s.Z.Item,{label:B("title"),name:"title[".concat(e.locale,"]"),rules:[{required:e.locale===Q,message:B("required")},{min:2,message:B("title.required")}],hidden:e.locale!==Q,children:(0,Y.jsx)(f.Z,{})},"title"+n)}))}),(0,Y.jsx)(h.Z,{span:24,children:(0,Y.jsx)(s.Z.Item,{label:B("phone"),name:"phone",rules:[{required:!0,message:B("required")}],children:(0,Y.jsx)(x.Z,{min:0,className:"w-100"})})})]})}),(0,Y.jsx)(h.Z,{span:12,children:X.map((function(e,n){return(0,Y.jsx)(s.Z.Item,{label:B("description"),name:"description[".concat(e.locale,"]"),rules:[{required:e.locale===Q,message:B("required")},{min:3,message:B("required")}],hidden:e.locale!==Q,children:(0,Y.jsx)(y.Z,{rows:4})},"desc"+n)}))}),(0,Y.jsx)(h.Z,{span:8,children:(0,Y.jsx)(s.Z.Item,{label:B("restaurant.tags"),name:"tags",rules:[{required:!1,message:B("required")}],children:(0,Y.jsx)(O.R,{mode:"multiple",fetchOptions:function(e){return te.apply(this,arguments)},refetch:W})})}),(0,Y.jsx)(h.Z,{span:8,children:(0,Y.jsx)(s.Z.Item,{label:B("seller"),name:"user",rules:[{required:!0,message:B("required")}],children:(0,Y.jsx)(O.R,{disabled:A,fetchOptions:function(e){return ee.apply(this,arguments)},refetch:W,dropdownRender:function(e){return(0,Y.jsxs)(Y.Fragment,{children:[e,(0,Y.jsx)(v.Z,{style:{margin:"8px 0"}}),(0,Y.jsx)(d.Z,{className:"w-100",disabled:A,icon:(0,Y.jsx)(L.Z,{}),onClick:re,children:B("add.user")})]})}})})}),(0,Y.jsx)(h.Z,{span:8,children:(0,Y.jsx)(s.Z.Item,{label:B("categories"),name:"categories",rules:[{required:!0,message:B("required")}],children:(0,Y.jsx)(O.R,{mode:"multiple",fetchOptions:function(e){return ne.apply(this,arguments)},refetch:W,dropdownRender:function(e){return(0,Y.jsxs)(Y.Fragment,{children:[e,(0,Y.jsx)(v.Z,{style:{margin:"8px 0"}}),(0,Y.jsx)(d.Z,{className:"w-100",icon:(0,Y.jsx)(L.Z,{}),onClick:ae,children:B("add.category")})]})}})})})]})})}),(0,Y.jsx)(h.Z,{span:8,children:(0,Y.jsx)(p.Z,{title:B("delivery"),children:(0,Y.jsxs)(Z.Z,{gutter:8,children:[(0,Y.jsx)(h.Z,{span:12,children:(0,Y.jsx)(s.Z.Item,{name:"price",label:B("min.price"),rules:[{required:!0,message:B("required")}],children:(0,Y.jsx)(x.Z,{className:"w-100"})})}),(0,Y.jsx)(h.Z,{span:12,children:(0,Y.jsx)(s.Z.Item,{name:"price_per_km",label:B("price.per.km"),rules:[{required:!0,message:B("required")}],children:(0,Y.jsx)(x.Z,{className:"w-100"})})})]})})}),(0,Y.jsx)(h.Z,{span:8,children:(0,Y.jsx)(p.Z,{title:B("delivery.time"),children:(0,Y.jsxs)(Z.Z,{gutter:12,children:[(0,Y.jsx)(h.Z,{span:12,children:(0,Y.jsx)(s.Z.Item,{name:"delivery_time_type",label:B("delivery_time_type"),rules:[{required:!0,message:B("required")}],children:(0,Y.jsxs)(j.Z,{className:"w-100",children:[(0,Y.jsx)(j.Z.Option,{value:"minute",label:B("minutes")}),(0,Y.jsx)(j.Z.Option,{value:"hour",label:B("hour")})]})})}),(0,Y.jsx)(h.Z,{span:12,children:(0,Y.jsx)(s.Z.Item,{name:"delivery_time_from",label:B("delivery_time_from"),rules:[{required:!0,message:B("required")}],children:(0,Y.jsx)(x.Z,{className:"w-100"})})}),(0,Y.jsx)(h.Z,{span:12,children:(0,Y.jsx)(s.Z.Item,{name:"delivery_time_to",label:B("delivery_time_to"),rules:[{required:!0,message:B("required")}],children:(0,Y.jsx)(x.Z,{className:"w-100"})})})]})})}),(0,Y.jsx)(h.Z,{span:8,children:(0,Y.jsx)(p.Z,{title:B("order.info"),children:(0,Y.jsxs)(Z.Z,{gutter:12,children:[(0,Y.jsx)(h.Z,{span:12,children:(0,Y.jsx)(s.Z.Item,{label:B("min.amount"),name:"min_amount",rules:[{required:!0,message:B("required")}],children:(0,Y.jsx)(x.Z,{min:0,className:"w-100"})})}),(0,Y.jsx)(h.Z,{span:12,children:(0,Y.jsx)(s.Z.Item,{label:B("tax"),name:"tax",rules:[{required:!0,message:B("required")}],children:(0,Y.jsx)(x.Z,{min:0,addonAfter:"%",className:"w-100"})})}),(0,Y.jsx)(h.Z,{span:12,children:(0,Y.jsx)(s.Z.Item,{label:B("admin.comission"),name:"percentage",rules:[{required:!0,message:B("required")}],children:(0,Y.jsx)(x.Z,{min:0,className:"w-100",addonAfter:"%"})})})]})})}),(0,Y.jsx)(h.Z,{span:24,children:(0,Y.jsx)(p.Z,{title:B("address"),children:(0,Y.jsxs)(Z.Z,{gutter:12,children:[(0,Y.jsx)(h.Z,{span:12,children:X.map((function(e,n){return(0,Y.jsx)(k.Z,{setLocation:M,form:o,item:e,idx:n,defaultLang:Q},n)}))}),(0,Y.jsx)(h.Z,{span:24,children:(0,Y.jsx)(q.Z,{location:D,setLocation:M,setAddress:function(e){return o.setFieldsValue((0,c.Z)({},"address[".concat(Q,"]"),e))}})})]})})}),V&&(0,Y.jsx)(F.Z,{visible:V,handleCancel:function(){return ie()}}),E&&(0,Y.jsx)(N.Z,{visible:E,handleCancel:function(){return ie()}})]})},M=t(90954),A=t(53149),B=t(17649),C=function(e){var n,t,u,c,m,Z,h,p,f,g=e.next,x=e.action_type,v=void 0===x?"":x,j=e.user,y=(0,w.$)().t,b=s.Z.useForm(),I=(0,a.Z)(b,1)[0],q=(0,o.s0)(),k=(0,_.I0)(),S=(0,o.UO)().uuid,L=(0,_.v9)((function(e){return e.menu}),_.wU).activeMenu,F=(0,i.useState)(!1),N=(0,a.Z)(F,2),O=N[0],H=N[1],C=(0,i.useState)(null!==(n=L.data)&&void 0!==n&&n.logo_img?[null===(t=L.data)||void 0===t?void 0:t.logo_img]:[]),U=(0,a.Z)(C,2),V=U[0],P=U[1],R=(0,i.useState)(null!==(u=L.data)&&void 0!==u&&u.background_img?[null===(c=L.data)||void 0===c?void 0:c.background_img]:[]),$=(0,a.Z)(R,2),E=$[0],J=$[1],K=(0,_.v9)((function(e){return e.globalSettings}),_.wU).settings,T=(0,i.useState)(null!==L&&void 0!==L&&null!==(m=L.data)&&void 0!==m&&m.location?{lat:parseFloat(null===L||void 0===L||null===(Z=L.data)||void 0===Z||null===(h=Z.location)||void 0===h?void 0:h.latitude),lng:parseFloat(null===L||void 0===L||null===(p=L.data)||void 0===p||null===(f=p.location)||void 0===f?void 0:f.longitude)}:(0,B.Z)(K)),W=(0,a.Z)(T,2),z=W[0],G=W[1];(0,i.useEffect)((function(){return function(){var e=I.getFieldsValue(!0);e.open_time=JSON.stringify(null===e||void 0===e?void 0:e.open_time),e.close_time=JSON.stringify(null===e||void 0===e?void 0:e.close_time),k((0,M.nc)({activeMenu:L,data:(0,r.Z)((0,r.Z)({},L.data),e)}))}}),[]);return(0,Y.jsx)(Y.Fragment,{children:(0,Y.jsxs)(s.Z,{form:I,name:"basic",layout:"vertical",onFinish:function(e){var n,t,a;H(!0);var i=(0,r.Z)((0,r.Z)({},e),{},{"images[0]":null===(n=V[0])||void 0===n?void 0:n.name,"images[1]":null===(t=E[0])||void 0===t?void 0:t.name,delivery_time_type:e.delivery_time_type,delivery_time_to:e.delivery_time_to,delivery_time_from:e.delivery_time_from,categories:e.categories.map((function(e){return e.value})),tags:null===e||void 0===e||null===(a=e.tags)||void 0===a?void 0:a.map((function(e){return e.value})),user_id:e.user.value,open:void 0,"location[latitude]":z.lat,"location[longitude]":z.lng,user:void 0,delivery_time:0,type:"restaurant"});"edit"===v?function(e,n){A.Z.update(S,n).then((function(){k((0,M.nc)({activeMenu:L,data:e})),g()})).catch((function(e){return console.error(e)})).finally((function(){return H(!1)}))}(e,i):function(e,n){A.Z.create(n).then((function(n){var t=n.data;k((0,M.SS)({id:"restaurant-".concat(t.uuid),url:"restaurant/".concat(t.uuid),name:y("add.restaurant"),data:(0,r.Z)((0,r.Z)({},t),{},{background_img:{name:null===t||void 0===t?void 0:t.background_img},logo_img:{name:null===t||void 0===t?void 0:t.logo_img}},e),refetch:!1})),q("/restaurant/".concat(t.uuid,"?step=1"))})).catch((function(e){return console.error(e)})).finally((function(){return H(!1)}))}(e,i)},initialValues:(0,r.Z)({open:!1,status:"new"},L.data),children:[(0,Y.jsx)(D,{logoImage:V,setLogoImage:P,backImage:E,setBackImage:J,form:I,location:z,setLocation:G,user:j}),(0,Y.jsx)(l.Z,{children:(0,Y.jsx)(d.Z,{type:"primary",htmlType:"submit",loading:O,children:y("next")})})]})})}},48662:function(e,n,t){var r=t(29439),a=t(18197),i=t(47313),s=t(51282),l=t(70816),d=t.n(l),o=t(78790),u=t(49682),c=t(58467),m=t(21429),Z=t(22899),h=t(46417);n.Z=function(e){var n=e.next,t=e.prev,l=a.Z.useForm(),p=(0,r.Z)(l,1)[0],f=(0,i.useState)([]),g=(0,r.Z)(f,2),x=g[0],v=g[1],j=(0,i.useState)(new Array(7).fill(!1)),y=(0,r.Z)(j,2),b=y[0],_=y[1],w=(0,i.useState)(!1),I=(0,r.Z)(w,2),q=I[0],k=I[1],S=(0,i.useState)(!1),L=(0,r.Z)(S,2),F=L[0],N=L[1],O=(0,c.UO)().uuid;return(0,i.useEffect)((function(){p.setFieldsValue({working_days:m.P}),O&&(N(!0),u.Z.getById(O).then((function(e){v(e.data.closed_dates.filter((function(e){return e.day>d()(new Date).format("YYYY-MM-DD")})).map((function(e){return new Date(e.day)})))})),o.Z.getById(O).then((function(e){_(0!==e.data.dates.length?e.data.dates.map((function(e){return e.disabled})):[]),0!==e.data.dates.length&&p.setFieldsValue({working_days:e.data.dates.map((function(e){return{title:e.day,from:d()(e.from,"HH:mm:ss"),to:d()(e.to,"HH:mm:ss"),disabled:Boolean(e.disabled)}}))})})).finally((function(){return N(!1)})))}),[]),(0,h.jsx)(h.Fragment,{children:F?(0,h.jsx)(s.Z,{}):(0,h.jsx)(Z.Z,{onFinish:function(e){k(!0);var t={dates:x?x.map((function(e){return d()(e).format("YYYY-MM-DD")})):void 0},r={dates:e.working_days.map((function(e){return{day:e.title,from:d()(e.from?e.from:"00").format("HH-mm"),to:d()(e.to?e.to:"00").format("HH-mm"),disabled:e.disabled}}))};u.Z.update(O,t).then((function(){n()})).finally((function(){return k(!1)})),0!==e.working_days.length&&o.Z.update(O,r).then((function(){n()})).finally((function(){return k(!1)}))},prev:t,form:p,lines:b,loadingBtn:q,days:x,setDays:v,setLines:_,weeks:m.P})})}}}]);