"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[1553],{30008:function(e,n,t){t.d(n,{Z:function(){return B}});var r=t(1413),a=t(29439),s=t(47313),i=t(18197),l=t(45705),d=t(59491),u=t(58467),o=t(2717),c=t(90954),m=t(49067),Z=t(24511),h=t(17649),p=t(74165),f=t(4942),x=t(15861),g=t(68197),j=t(59624),v=t(77181),y=t(66672),b=t(86345),_=t(6289),w=t(46155),I=t(74294),q=t(52421),k=t(97388),S=(t(75049),t(5764)),F=t(98447),N=t(13622),L=t(61197),O=t(30763),H=t(49986),Y=t(48210),D=t(45005),M=t(46417),A=function(e){var n=e.backImage,t=e.setBackImage,r=e.logoImage,l=e.setLogoImage,u=e.form,c=e.user,m=e.setLocation,h=e.location,A=(0,Z.$)().t,B=(0,s.useState)(null),C=(0,a.Z)(B,2),R=C[0],U=C[1],V=(0,s.useState)(null),P=(0,a.Z)(V,2),E=P[0],J=P[1],$=(0,s.useState)(null),T=(0,a.Z)($,2),z=T[0],G=T[1],K=(0,o.v9)((function(e){return e.formLang}),o.wU),Q=K.defaultLang,W=K.languages;function X(){return(X=(0,x.Z)((0,p.Z)().mark((function e(n){var t;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={search:n,roles:"user",empty_shop:1},G(!1),e.abrupt("return",H.Z.search(t).then((function(e){return e.data.map((function(e){return{label:e.firstname+" "+(e.lastname||""),value:e.id}}))})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ee(){return(ee=(0,x.Z)((0,p.Z)().mark((function e(n){var t;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={search:n,type:"shop"},G(!1),e.abrupt("return",O.Z.getAll(t).then((function(e){return e.data.map((function(e){var n;return{label:(null===(n=e.translation)||void 0===n?void 0:n.title)||"no name",value:e.id}}))})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(){return(ne=(0,x.Z)((0,p.Z)().mark((function e(n){var t;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return G(!1),t={search:n},e.abrupt("return",L.Z.getAll(t).then((function(e){return e.data.map((function(e){var n;return{label:(null===(n=e.translation)||void 0===n?void 0:n.title)||"no name",value:e.id}}))})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var te=function(){U(!0),G(!0)},re=function(){J(!0),G(!0)},ae=function(){U(!1),J(!1)};return(0,M.jsxs)(g.Z,{gutter:12,children:[(0,M.jsx)(j.Z,{span:24,children:(0,M.jsx)(v.Z,{children:(0,M.jsxs)(g.Z,{gutter:12,children:[(0,M.jsx)(j.Z,{span:4,children:(0,M.jsx)(i.Z.Item,{label:A("logo.image"),children:(0,M.jsx)(S.Z,{type:"shops/logo",imageList:r,setImageList:l,form:u,multiple:!1,name:"logo_img"})})}),(0,M.jsx)(j.Z,{span:4,children:(0,M.jsx)(i.Z.Item,{label:A("background.image"),children:(0,M.jsx)(S.Z,{type:"shops/background",imageList:n,setImageList:t,form:u,multiple:!1,name:"background_img"})})}),(0,M.jsx)(j.Z,{span:10,children:(0,M.jsx)(i.Z.Item,{label:A("status.note"),name:"status_note",children:(0,M.jsx)(q.Z,{rows:4})})}),(0,M.jsx)(j.Z,{span:4,children:(0,M.jsx)(i.Z.Item,{name:"status",label:A("status"),children:(0,M.jsx)(y.Z,{disabled:!0})})}),(0,M.jsx)(j.Z,{span:2,children:(0,M.jsx)(i.Z.Item,{label:A("open"),name:"open",valuePropName:"checked",children:(0,M.jsx)(b.Z,{disabled:!0})})})]})})}),(0,M.jsx)(j.Z,{span:24,children:(0,M.jsx)(v.Z,{title:A("general"),children:(0,M.jsxs)(g.Z,{gutter:12,children:[(0,M.jsx)(j.Z,{span:12,children:(0,M.jsxs)(g.Z,{gutter:12,children:[(0,M.jsx)(j.Z,{span:24,children:W.map((function(e,n){return(0,M.jsx)(i.Z.Item,{label:A("title"),name:"title[".concat(e.locale,"]"),rules:[{required:e.locale===Q,message:A("required")},{min:2,message:A("title.requared")}],hidden:e.locale!==Q,children:(0,M.jsx)(y.Z,{})},"title"+n)}))}),(0,M.jsx)(j.Z,{span:24,children:(0,M.jsx)(i.Z.Item,{label:A("phone"),name:"phone",rules:[{required:!0,message:A("required")}],children:(0,M.jsx)(_.Z,{min:0,className:"w-100"})})})]})}),(0,M.jsx)(j.Z,{span:12,children:W.map((function(e,n){return(0,M.jsx)(i.Z.Item,{label:A("description"),name:"description[".concat(e.locale,"]"),rules:[{required:e.locale===Q,message:A("required")},{min:3,message:A("requared")}],hidden:e.locale!==Q,children:(0,M.jsx)(q.Z,{rows:4})},"desc"+n)}))}),(0,M.jsx)(j.Z,{span:8,children:(0,M.jsx)(i.Z.Item,{label:A("shop.tags"),name:"tags",rules:[{required:!1,message:A("required")}],children:(0,M.jsx)(N.R,{mode:"multiple",fetchOptions:function(e){return ne.apply(this,arguments)},refetch:z})})}),(0,M.jsx)(j.Z,{span:8,children:(0,M.jsx)(i.Z.Item,{label:A("seller"),name:"user",rules:[{required:!0,message:A("required")}],children:(0,M.jsx)(N.R,{disabled:!c,fetchOptions:function(e){return X.apply(this,arguments)},refetch:z,dropdownRender:function(e){return(0,M.jsxs)(M.Fragment,{children:[e,(0,M.jsx)(w.Z,{style:{margin:"8px 0"}}),(0,M.jsx)(d.Z,{className:"w-100",icon:(0,M.jsx)(F.Z,{}),onClick:te,children:A("add.user")})]})}})})}),(0,M.jsx)(j.Z,{span:8,children:(0,M.jsx)(i.Z.Item,{label:A("categories"),name:"categories",rules:[{required:!0,message:A("required")}],children:(0,M.jsx)(N.R,{mode:"multiple",fetchOptions:function(e){return ee.apply(this,arguments)},refetch:z,dropdownRender:function(e){return(0,M.jsxs)(M.Fragment,{children:[e,(0,M.jsx)(w.Z,{style:{margin:"8px 0"}}),(0,M.jsx)(d.Z,{className:"w-100",icon:(0,M.jsx)(F.Z,{}),onClick:re,children:A("add.category")})]})}})})})]})})}),(0,M.jsx)(j.Z,{span:8,children:(0,M.jsx)(v.Z,{title:A("delivery"),children:(0,M.jsxs)(g.Z,{gutter:8,children:[(0,M.jsx)(j.Z,{span:12,children:(0,M.jsx)(i.Z.Item,{name:"price",label:A("min.price"),rules:[{required:!0,message:A("required")}],children:(0,M.jsx)(_.Z,{className:"w-100"})})}),(0,M.jsx)(j.Z,{span:12,children:(0,M.jsx)(i.Z.Item,{name:"price_per_km",label:A("price.per.km"),rules:[{required:!0,message:A("required")}],children:(0,M.jsx)(_.Z,{className:"w-100"})})})]})})}),(0,M.jsx)(j.Z,{span:8,children:(0,M.jsx)(v.Z,{title:A("delivery.time"),children:(0,M.jsxs)(g.Z,{gutter:12,children:[(0,M.jsx)(j.Z,{span:12,children:(0,M.jsx)(i.Z.Item,{name:"delivery_time_type",label:A("delivery_time_type"),rules:[{required:!0,message:A("required")}],children:(0,M.jsxs)(I.Z,{className:"w-100",children:[(0,M.jsx)(I.Z.Option,{value:"minute",label:A("minutes")}),(0,M.jsx)(I.Z.Option,{value:"hour",label:A("hour")})]})})}),(0,M.jsx)(j.Z,{span:12,children:(0,M.jsx)(i.Z.Item,{name:"delivery_time_from",label:A("delivery_time_from"),rules:[{required:!0,message:A("required")}],children:(0,M.jsx)(_.Z,{className:"w-100"})})}),(0,M.jsx)(j.Z,{span:12,children:(0,M.jsx)(i.Z.Item,{name:"delivery_time_to",label:A("delivery_time_to"),rules:[{required:!0,message:A("required")}],children:(0,M.jsx)(_.Z,{className:"w-100"})})})]})})}),(0,M.jsx)(j.Z,{span:8,children:(0,M.jsx)(v.Z,{title:A("order.info"),children:(0,M.jsxs)(g.Z,{gutter:12,children:[(0,M.jsx)(j.Z,{span:12,children:(0,M.jsx)(i.Z.Item,{label:A("min.amount"),name:"min_amount",rules:[{required:!0,message:A("required")}],children:(0,M.jsx)(_.Z,{min:0,className:"w-100"})})}),(0,M.jsx)(j.Z,{span:12,children:(0,M.jsx)(i.Z.Item,{label:A("tax"),name:"tax",rules:[{required:!0,message:A("required")}],children:(0,M.jsx)(_.Z,{min:0,addonAfter:"%",className:"w-100"})})}),(0,M.jsx)(j.Z,{span:12,children:(0,M.jsx)(i.Z.Item,{label:A("admin.comission"),name:"percentage",rules:[{required:!0,message:A("required")}],children:(0,M.jsx)(_.Z,{min:0,className:"w-100",addonAfter:"%"})})})]})})}),(0,M.jsx)(j.Z,{span:24,children:(0,M.jsx)(v.Z,{title:A("address"),children:(0,M.jsxs)(g.Z,{gutter:12,children:[(0,M.jsx)(j.Z,{span:12,children:W.map((function(e,n){return(0,M.jsx)(i.Z.Item,{label:A("address"),name:"address[".concat(e.locale,"]"),rules:[{required:e.locale===Q,message:A("required")}],hidden:e.locale!==Q,children:(0,M.jsx)(y.Z,{})},"address"+n)}))}),(0,M.jsx)(j.Z,{span:24,children:(0,M.jsx)(k.Z,{location:h,setLocation:m,setAddress:function(e){return u.setFieldsValue((0,f.Z)({},"address[".concat(Q,"]"),e))}})})]})})}),R&&(0,M.jsx)(Y.Z,{visible:R,handleCancel:function(){return ae()}}),E&&(0,M.jsx)(D.Z,{visible:E,handleCancel:function(){return ae()}})]})},B=function(e){var n,t,p,f,x,g,j,v,y,b=e.next,_=e.action_type,w=void 0===_?"":_,I=e.user,q=(0,Z.$)().t,k=i.Z.useForm(),S=(0,a.Z)(k,1)[0],F=(0,u.s0)(),N=(0,o.I0)(),L=(0,u.UO)().uuid,O=(0,o.v9)((function(e){return e.menu}),o.wU).activeMenu,H=(0,o.v9)((function(e){return e.globalSettings}),o.wU).settings,Y=(0,s.useState)(null!==O&&void 0!==O&&null!==(n=O.data)&&void 0!==n&&n.location?{lat:parseFloat(null===O||void 0===O||null===(t=O.data)||void 0===t||null===(p=t.location)||void 0===p?void 0:p.latitude),lng:parseFloat(null===O||void 0===O||null===(f=O.data)||void 0===f||null===(x=f.location)||void 0===x?void 0:x.longitude)}:(0,h.Z)(H)),D=(0,a.Z)(Y,2),B=D[0],C=D[1],R=(0,s.useState)(!1),U=(0,a.Z)(R,2),V=U[0],P=U[1],E=(0,s.useState)(null!==(g=O.data)&&void 0!==g&&g.logo_img?[null===(j=O.data)||void 0===j?void 0:j.logo_img]:[]),J=(0,a.Z)(E,2),$=J[0],T=J[1],z=(0,s.useState)(null!==(v=O.data)&&void 0!==v&&v.background_img?[null===(y=O.data)||void 0===y?void 0:y.background_img]:[]),G=(0,a.Z)(z,2),K=G[0],Q=G[1];(0,s.useEffect)((function(){return function(){var e=S.getFieldsValue(!0);e.open_time=JSON.stringify(null===e||void 0===e?void 0:e.open_time),e.close_time=JSON.stringify(null===e||void 0===e?void 0:e.close_time),N((0,c.nc)({activeMenu:O,data:(0,r.Z)((0,r.Z)({},O.data),e)}))}}),[]);return(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)(i.Z,{form:S,name:"basic",layout:"vertical",onFinish:function(e){var n,t,a;P(!0);var s,i=(0,r.Z)((0,r.Z)({},e),{},{"images[0]":null===(n=$[0])||void 0===n?void 0:n.name,"images[1]":null===(t=K[0])||void 0===t?void 0:t.name,delivery_time_type:e.delivery_time_type,delivery_time_to:e.delivery_time_to,delivery_time_from:e.delivery_time_from,categories:e.categories.map((function(e){return e.value})),tags:null===e||void 0===e||null===(a=e.tags)||void 0===a?void 0:a.map((function(e){return e.value})),user_id:e.user.value,open:void 0,"location[latitude]":B.lat,"location[longitude]":B.lng,user:void 0,delivery_time:0,type:"shop"});"edit"===w?function(e,n){m.Z.update(L,n).then((function(){N((0,c.nc)({activeMenu:O,data:e})),b()})).catch((function(e){return console.error(e.response.data.params)})).finally((function(){return P(!1)}))}(e,i):(s=i,m.Z.create(s).then((function(e){var n=e.data;N((0,c.SS)({id:"shop-".concat(n.uuid),url:"shop/".concat(n.uuid),name:q("add.shop"),data:n,refetch:!1})),F("/shop/".concat(n.uuid,"?step=1"))})).catch((function(e){return console.error(e.response.data.params)})).finally((function(){return P(!1)})))},initialValues:(0,r.Z)({open:!1,status:"new"},O.data),children:[(0,M.jsx)(A,{form:S,user:I,backImage:K,setBackImage:Q,logoImage:$,setLogoImage:T,location:B,setLocation:C}),(0,M.jsx)(l.Z,{children:(0,M.jsx)(d.Z,{type:"primary",htmlType:"submit",loading:V,children:q("next")})})]})})}},20131:function(e,n,t){var r=t(29439),a=t(47313),s=t(51282),i=t(70816),l=t.n(i),d=t(78790),u=t(49682),o=t(58467),c=t(21429),m=t(22899),Z=t(18197),h=t(46417);n.Z=function(e){var n=e.next,t=e.prev,i=Z.Z.useForm(),p=(0,r.Z)(i,1)[0],f=(0,a.useState)([]),x=(0,r.Z)(f,2),g=x[0],j=x[1],v=(0,a.useState)(new Array(7).fill(!1)),y=(0,r.Z)(v,2),b=y[0],_=y[1],w=(0,a.useState)(!1),I=(0,r.Z)(w,2),q=I[0],k=I[1],S=(0,a.useState)(!1),F=(0,r.Z)(S,2),N=F[0],L=F[1],O=(0,o.UO)().uuid;return(0,a.useEffect)((function(){p.setFieldsValue({working_days:c.P}),O&&(L(!0),u.Z.getById(O).then((function(e){j(e.data.closed_dates.filter((function(e){return e.day>l()(new Date).format("YYYY-MM-DD")})).map((function(e){return new Date(e.day)})))})),d.Z.getById(O).then((function(e){_(0!==e.data.dates.length?e.data.dates.map((function(e){return e.disabled})):[]),0!==e.data.dates.length&&p.setFieldsValue({working_days:e.data.dates.map((function(e){return{title:e.day,from:l()(e.from,"HH:mm:ss"),to:l()(e.to,"HH:mm:ss"),disabled:Boolean(e.disabled)}}))})})).finally((function(){return L(!1)})))}),[]),(0,h.jsx)(h.Fragment,{children:N?(0,h.jsx)(s.Z,{}):(0,h.jsx)(m.Z,{onFinish:function(e){k(!0);var t={dates:g?g.map((function(e){return l()(e).format("YYYY-MM-DD")})):void 0},r={dates:e.working_days.map((function(e){return{day:e.title,from:l()(e.from?e.from:"00").format("HH-mm"),to:l()(e.to?e.to:"00").format("HH-mm"),disabled:e.disabled}}))};u.Z.update(O,t).then((function(){n()})).finally((function(){return k(!1)})),0!==e.working_days.length&&d.Z.update(O,r).then((function(){n()})).finally((function(){return k(!1)}))},prev:t,form:p,lines:b,loadingBtn:q,days:g,setDays:j,setLines:_,weeks:c.P})})}}}]);