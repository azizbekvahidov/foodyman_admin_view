"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[9815],{38628:function(e,t,n){var a=n(77181),o=n(14133),i=(n(47313),n(46417));t.Z=function(e){var t=e.loading;return(0,i.jsx)(a.Z,{className:"order-card",children:(0,i.jsx)(o.Z,{loading:t,avatar:!0,active:!0})})}},98501:function(e,t,n){n.d(t,{Q:function(){return a}});var a={new:[1,2,3,4,5],accepted:[1,2,3,4,5],ready:[1,2,3,4,5],on_a_way:[1,2,3,4,5],delivered:[1,2,3,4,5],canceled:[1,2,3,4,5]}},19815:function(e,t,n){n.r(t),n.d(t,{default:function(){return me}});var a=n(74165),o=n(15861),i=n(4942),l=n(93433),d=n(1413),r=n(29439),s=n(47313),c=n(99096),u=n(45705),v=n(59491),f=n(77181),p=n(58467),h=n(55768),Z=n(15386),m=n(2717),x=n(90954),g=n(24511),y=n(80314),j=n(22054),b=n(41481),_=n(73270),w=n(89281),D=n(49986),M=n(7920),Y=n(24077),S=n(80355),I=n(24391),C=n(34491),T=n(7370),k=n(74580),P=n(69658),O=n(70816),A=n.n(O),N=n(53149),z=n(43773),H=n(93709),L=n(66204),E=n(43880),U=n(46417),V=function(e){var t=e.children,n=e.title,a=e.name,o=e.isDropDisabled,i=e.total,l=void 0===i?0:i,d=e.loading,r=void 0!==d&&d,s=e.reloadOrder,c=(0,g.$)().t;return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(H.Z,{message:(0,U.jsxs)(u.Z,{children:[(0,U.jsx)(z.Z,{size:20,style:{cursor:"pointer"},spin:r,onClick:s}),c(n),(0,U.jsx)(L.Z,{children:r?(0,U.jsx)(z.Z,{spin:!0}):l})]}),className:"mb-4 ".concat(a),style:{textAlign:"center",fontSize:16,textTransform:"capitalize"}}),(0,U.jsx)(E.bK,{droppableId:a,isDropDisabled:o,children:function(e){return(0,U.jsx)("div",{ref:e.innerRef,className:"h-screen",style:{opacity:o?.6:1},children:(0,U.jsxs)(U.Fragment,{children:[t,e.placeholder]})})}})]})},R=n(72652),B=n(39548),F=n(60931),Q=n(45427),$=n(86949),K=n(35529),G=n(91805),J=n(47515),W=n(6986),q=n(31741),X=n(14133),ee=n(45334),te=n(42346),ne=n(84017),ae=n(5958),oe=n(79492),ie=f.Z.Meta,le=function(e){var t,n,a,o,i,l,d,r,s,c,v,p=e.data,h=e.goToShow,Z=e.loading,m=e.setLocationsMap,x=e.setId,y=e.setIsModalVisible,j=e.setText,b=e.setDowloadModal,_=e.setTabType,w=[{title:"Client",icon:(0,U.jsx)(B.Z,{}),data:"".concat((null===(t=p.user)||void 0===t?void 0:t.firstname)||"-"," ").concat((null===(n=p.user)||void 0===n?void 0:n.lastname)||"-")},{title:"Deliveryman",icon:(0,U.jsx)(F.Z,{}),data:"".concat((null===(a=p.deliveryman)||void 0===a?void 0:a.firstname)||"-"," ").concat((null===(o=p.deliveryman)||void 0===o?void 0:o.lastname)||"-")},{title:"Amount",icon:(0,U.jsx)(Q.Z,{}),data:(0,ne.Z)(null===p||void 0===p?void 0:p.total_price,null===(i=p.currency)||void 0===i?void 0:i.symbol)},{title:"Payment type",icon:(0,U.jsx)($.Z,{}),data:(null===(l=p.transaction)||void 0===l||null===(d=l.payment_system)||void 0===d?void 0:d.tag)||"-"},{title:"Payment status",icon:(0,U.jsx)(K.Z,{}),data:(null===(r=p.transaction)||void 0===r?void 0:r.status)||"-"},{title:"Delivery date",icon:(0,U.jsx)(G.Z,{}),data:A()(null===p||void 0===p?void 0:p.delivery_date).format("YYYY-MM-DD")||"-"},{title:"Created at",icon:(0,U.jsx)(G.Z,{}),data:A()(null===p||void 0===p?void 0:p.created_at).format("YYYY-MM-DD")||"-"}],D=(0,g.$)().t,M=(0,oe.Z)().isDemo,Y=[(0,U.jsx)(ae.Y4r,{size:20,onClick:function(e){e.stopPropagation(),m(p.id)}}),(0,U.jsx)(J.Z,{onClick:function(e){M?C.Am.warning(D("cannot.work.demo")):(e.stopPropagation(),x([p.id]),y(!0),j(!0),_(p.status))}}),(0,U.jsx)(W.Z,{onClick:function(e){e.stopPropagation(),b(p.id)}}),(0,U.jsx)(q.Z,{onClick:function(e){e.stopPropagation(),h(p)}})];return(0,U.jsx)(f.Z,{actions:Y,className:"order-card",children:(0,U.jsxs)(X.Z,{loading:Z,avatar:!0,active:!0,children:[(0,U.jsx)(ie,{avatar:(0,U.jsx)(ee.C,{src:null===p||void 0===p||null===(s=p.shop)||void 0===s?void 0:s.logo_img}),description:"#".concat(p.id),title:null===p||void 0===p||null===(c=p.shop)||void 0===c||null===(v=c.translation)||void 0===v?void 0:v.title}),(0,U.jsx)(te.ZP,{itemLayout:"horizontal",dataSource:w,renderItem:function(e,t){return(0,U.jsx)(te.ZP.Item,{children:(0,U.jsxs)(u.Z,{children:[null===e||void 0===e?void 0:e.icon,"".concat(null===e||void 0===e?void 0:e.title,":  ").concat(null===e||void 0===e?void 0:e.data)]})},t)}})]})})},de=n(7142),re=n(82508),se=n(98501),ce=n(38628),ue=["new","accepted","ready","on_a_way","delivered","canceled"],ve=function(e){var t=e.goToEdit,n=e.goToShow,a=e.fetchOrderAllItem,o=e.fetchOrders,i=e.setLocationsMap,l=e.setId,c=e.setIsModalVisible,u=e.setText,v=e.setDowloadModal,f=e.type,p=e.setTabType,h=(0,m.I0)(),Z=(0,m.v9)((function(e){return e.orders}),m.wU).items,x=(0,m.v9)((function(e){return e.orders}),m.wU),g=(0,s.useState)(""),y=(0,r.Z)(g,2),b=y[0],_=y[1],w=(0,s.useState)({}),D=(0,r.Z)(w,2),M=D[0],Y=D[1],S=(0,s.useState)({}),I=(0,r.Z)(S,2),k=I[0],P=I[1],O=function(e){if(e.destination){var t,n;e.destination&&M.source.droppableId!==e.destination.droppableId&&(t=e.draggableId,n={status:e.destination.droppableId},T.Z.updateStatus(t,n).then((function(e){C.Am.success("#".concat(t," order status changed"))})));var a=(0,d.Z)({},Z),o=function(e,t){var n=Array.from(e),a=n.splice(t,1);return[(0,r.Z)(a,1)[0],n]}(a[e.source.droppableId],e.source.index),i=(0,r.Z)(o,2),l=i[0],s=i[1];a[e.source.droppableId]=s;var c=a[e.destination.droppableId];a[e.destination.droppableId]=function(e,t,n){var a=Array.from(e);return a.splice(t,0,n),a}(c,e.destination.index,l),h((0,j.U7)(a)),P(null)}},A=function(e){return(0!==e||k!==ue.length-1)&&!!Boolean(k>e)};(0,s.useEffect)((function(){h((0,j.H5)()),a()}),[f]);return(0,U.jsx)(E.Z5,{onDragEnd:O,onDragStart:function(e){var t=ue.findIndex((function(t){return t===e.source.droppableId}));Y(e),P(t)},children:(0,U.jsx)("div",{className:"order-board",children:null===ue||void 0===ue?void 0:ue.map((function(e,a){var r,s,f,m;return(0,U.jsx)("div",{className:"dnd-column",children:(0,U.jsx)(V,{title:e,onDragEnd:O,name:e,isDropDisabled:A(a),total:null===(r=Z[e])||void 0===r?void 0:r.length,loading:x[e].loading,reloadOrder:function(){return function(e){h((0,j.x9)(e)),o({status:e})}(e)},children:(0,U.jsxs)(de.ZP,{onScroll:function(t){return function(e,t){var n=e.target.lastChild,a=e.target.clientHeight+e.target.scrollTop;n&&a>n.offsetTop+n.clientHeight+19.9&&x[t].meta.last_page>x[t].meta.current_page&&!x[t].loading&&(_(t),o({page:x[t].meta.current_page+1,perPage:5,status:t}))}(t,e)},autoHeight:!0,autoHeightMin:"75vh",autoHeightMax:"75vh",autoHide:!0,id:e,children:[Boolean(x[e].loading&&!(null!==(s=Z[e])&&void 0!==s&&s.length))?null===(m=se.Q[e])||void 0===m?void 0:m.map((function(){return(0,U.jsx)(ce.Z,{loading:!0})})):null===(f=Z[e])||void 0===f?void 0:f.map((function(e,a){return(0,U.jsx)(U.Fragment,{children:(0,U.jsx)(E._l,{draggableId:e.id.toString(),index:a,children:function(a,o){return(0,U.jsx)("div",(0,d.Z)((0,d.Z)((0,d.Z)({ref:a.innerRef},a.draggableProps),a.dragHandleProps),{},{children:(0,U.jsx)(le,{data:e,goToEdit:t,goToShow:n,setLocationsMap:i,setId:l,setIsModalVisible:c,setText:u,setDowloadModal:v,setTabType:p})}))}},e.id)})})),x[e].loading&&e===b&&(0,U.jsx)(R.Z,{indicator:(0,U.jsx)(re.Z,{style:{fontSize:24},spin:!0})})]})})},e)}))})})},fe=n(21186),pe=n(3925),he=n(97421),Ze=c.Z.RangePicker;function me(){var e,t,n,c,O=(0,m.I0)(),z=(0,p.s0)(),H=(0,g.$)().t,L=(0,p.UO)().type,E=(0,m.v9)((function(e){return e.orderStatus}),m.wU).statusList,V=(0,s.useState)(null),R=(0,r.Z)(V,2),B=R[0],F=R[1],Q=(0,s.useState)(null),$=(0,r.Z)(Q,2),K=$[0],G=$[1],J=(0,s.useState)(null),W=(0,r.Z)(J,2),q=W[0],X=W[1],ee=(0,s.useState)(!1),te=(0,r.Z)(ee,2),ne=te[0],ae=te[1],oe=(0,s.useState)(null),ie=(0,r.Z)(oe,2),le=ie[0],de=ie[1],re=(0,s.useState)(null),se=(0,r.Z)(re,2),ce=se[0],ue=se[1],me=(0,s.useContext)(k._).setIsModalVisible,xe=(0,m.v9)((function(e){return e.menu}),m.wU).activeMenu,ge=(0,s.useState)(null),ye=(0,r.Z)(ge,2),je=ye[0],be=ye[1],_e=(0,s.useState)(null),we=(0,r.Z)(_e,2),De=we[0],Me=we[1],Ye=(0,s.useState)(!1),Se=(0,r.Z)(Ye,2),Ie=Se[0],Ce=Se[1],Te=(0,s.useState)(null),ke=(0,r.Z)(Te,2),Pe=ke[0],Oe=ke[1],Ae=null===xe||void 0===xe?void 0:xe.data,Ne={search:null!==Ae&&void 0!==Ae&&Ae.search?Ae.search:void 0,perPage:(null===Ae||void 0===Ae?void 0:Ae.perPage)||5,page:(null===Ae||void 0===Ae?void 0:Ae.page)||1,user_id:null===Ae||void 0===Ae?void 0:Ae.user_id,status:"deleted_at"!==(null===Ae||void 0===Ae?void 0:Ae.role)&&(null===Ae||void 0===Ae?void 0:Ae.role),shop_id:null!==(null===(e=xe.data)||void 0===e?void 0:e.shop_id)?null===(t=xe.data)||void 0===t?void 0:t.shop_id:null,delivery_type:"scheduled"!==L?L:void 0,delivery_date_from:"scheduled"===L?A()().add(1,"day").format("YYYY-MM-DD"):void 0,date_from:(null===Pe||void 0===Pe||null===(n=Pe[0])||void 0===n?void 0:n.format("YYYY-MM-DD"))||void 0,date_to:(null===Pe||void 0===Pe||null===(c=Pe[1])||void 0===c?void 0:c.format("YYYY-MM-DD"))||void 0};(0,y.Z)((function(){O((0,j.o1)(Ne)),Ve()}),[Ae,Pe,L]);var ze=function(e,t){O((0,x.nc)({activeMenu:xe,data:(0,d.Z)((0,d.Z)({},Ae),(0,i.Z)({},t,e))}))};function He(){return He=(0,o.Z)((0,a.Z)().mark((function e(t){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={search:t,perPage:10},e.abrupt("return",D.Z.search(n).then((function(e){return e.data.map((function(e){return{label:"".concat(e.firstname," ").concat(e.lastname),value:e.id}}))})));case 2:case"end":return e.stop()}}),e)}))),He.apply(this,arguments)}var Le=function(){F(null),de(null),G(null),X(null)};function Ee(){return Ee=(0,o.Z)((0,a.Z)().mark((function e(t){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={search:t,status:"approved"},e.abrupt("return",N.Z.getAll(n).then((function(e){return e.data.map((function(e){var t;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id}}))})));case 2:case"end":return e.stop()}}),e)}))),Ee.apply(this,arguments)}var Ue=function(e){var t,n,a,o,i=(0,d.Z)((0,d.Z)({},e),{},{delivery_type:"scheduled"!==L?L:void 0,delivery_date_from:"scheduled"===L?A()().add(1,"day").format("YYYY-MM-DD"):void 0,search:null!==Ae&&void 0!==Ae&&Ae.search?Ae.search:void 0,user_id:null===Ae||void 0===Ae?void 0:Ae.user_id,status:null===e||void 0===e?void 0:e.status,shop_id:null!==(null===(t=xe.data)||void 0===t?void 0:t.shop_id)?null===(n=xe.data)||void 0===n?void 0:n.shop_id:null,date_from:(null===Pe||void 0===Pe||null===(a=Pe[0])||void 0===a?void 0:a.format("YYYY-MM-DD"))||void 0,date_to:(null===Pe||void 0===Pe||null===(o=Pe[1])||void 0===o?void 0:o.format("YYYY-MM-DD"))||void 0});switch(null===e||void 0===e?void 0:e.status){case"new":O((0,j.O7)(i));break;case"accepted":O((0,j.We)(i));break;case"ready":O((0,j.wC)(i));break;case"on_a_way":O((0,j.Ri)(i));break;case"delivered":O((0,j.Rd)(i));break;case"canceled":O((0,j.eV)(i));break;default:console.log("Sorry, we are out of")}},Ve=function(){Ue({status:"new"}),Ue({status:"accepted"}),Ue({status:"ready"}),Ue({status:"on_a_way"}),Ue({status:"delivered"}),Ue({status:"canceled"})};return(0,s.useEffect)((function(){null!==xe&&void 0!==xe&&xe.refetch&&(O((0,j.AU)(Ne)),O((0,x.A_)(xe)))}),[null===xe||void 0===xe?void 0:xe.refetch]),(0,U.jsxs)(U.Fragment,{children:[(0,U.jsxs)(u.Z,{className:"w-100 justify-content-end mb-3",children:[(0,U.jsx)(fe.Z,{listType:"orders-board"}),(0,U.jsx)(v.Z,{type:"primary",icon:(0,U.jsx)(h.Z,{}),onClick:function(){O((0,_.bn)()),O((0,x.K0)({id:"pos.system_01",url:"pos-system",name:"pos.system"})),z("/pos-system")},style:{width:"100%"},children:H("add.order")})]}),(0,U.jsx)(f.Z,{children:(0,U.jsxs)(u.Z,{wrap:!0,className:"order-filter",size:[8,15],children:[(0,U.jsx)(b.Z,{defaultValue:null===Ae||void 0===Ae?void 0:Ae.search,resetSearch:!(null!==Ae&&void 0!==Ae&&Ae.search),placeholder:H("search"),handleChange:function(e){return ze(e,"search")}}),(0,U.jsx)(w.h,{placeholder:H("select.shop"),fetchOptions:function(e){return Ee.apply(this,arguments)},style:{width:"100%"},onSelect:function(e){return ze(e.value,"shop_id")},onDeselect:function(){return ze(null,"shop_id")},allowClear:!0,value:null===Ae||void 0===Ae?void 0:Ae.shop_id}),(0,U.jsx)(w.h,{placeholder:H("select.client"),fetchOptions:function(e){return He.apply(this,arguments)},onSelect:function(e){return ze(e.value,"user_id")},onDeselect:function(){return ze(null,"user_id")},style:{width:"100%"},value:null===Ae||void 0===Ae?void 0:Ae.user_id}),(0,U.jsx)(Ze,{defaultValue:Pe,onChange:function(e){ze(JSON.stringify(e),"data_time"),Oe(e)},disabledDate:function(e){return e&&e>A()().endOf("day")},allowClear:!0,style:{width:"100%"}}),(0,U.jsxs)(v.Z,{onClick:function(){ae(!0),T.Z.export().then((function(e){var t=he.S0+e.data.file_name;window.location.href=t})).finally((function(){return ae(!1)}))},loading:ne,style:{width:"100%"},children:[(0,U.jsx)(pe.bwQ,{className:"mr-2"}),H("export")]}),(0,U.jsx)(v.Z,{icon:(0,U.jsx)(Z.Z,{}),onClick:function(){(0,m.dC)((function(){O((0,j.H5)()),O((0,x.nc)({activeMenu:xe,data:null}))})),Ve()},style:{width:"100%"},children:H("clear")})]})}),(0,U.jsx)(ve,{goToEdit:function(e){O((0,_.bn)()),O((0,x.bL)({url:"order/".concat(e.id),id:"order_edit",name:H("edit.order")})),z("/order/".concat(e.id))},goToShow:function(e){O((0,x.bL)({url:"order/details/".concat(e.id),id:"order_details",name:H("order.details")})),z("/order/details/".concat(e.id))},fetchOrderAllItem:Ve,fetchOrders:Ue,setLocationsMap:G,setId:be,setIsModalVisible:me,setText:Me,setDowloadModal:X,type:L,setTabType:ue}),B&&(0,U.jsx)(M.Z,{orderDetails:B,handleCancel:Le,status:E}),le&&(0,U.jsx)(Y.Z,{orderDetails:le,handleCancel:Le}),K&&(0,U.jsx)(S.Z,{id:K,handleCancel:Le}),q&&(0,U.jsx)(I.Z,{id:q,handleCancel:Le}),(0,U.jsx)(P.Z,{click:function(){Ce(!0);var e=(0,d.Z)({},Object.assign.apply(Object,[{}].concat((0,l.Z)(je.map((function(e,t){return(0,i.Z)({},"ids[".concat(t,"]"),e)}))))));T.Z.delete(e).then((function(){C.Am.success(H("successfully.deleted")),me(!1),Ve({status:ce}),Me(null)})).finally((function(){return Ce(!1)}))},text:H(De?"delete":"all.delete"),loading:Ie,setText:be})]})}},21186:function(e,t,n){var a=n(39180),o=(n(47313),n(58821)),i=n(54972),l=n(58467),d=n(46417),r=[{value:"orders-board",title:"Board",icon:(0,d.jsx)(i.Ez2,{size:20})},{value:"orders",title:"List",icon:(0,d.jsx)(o.Ps6,{size:20})}];t.Z=function(e){var t=e.listType,n=(0,l.UO)().type,o=(0,l.s0)();return(0,d.jsx)(a.ZP.Group,{value:t,onChange:function(e){o("/".concat(e.target.value).concat(n?"/".concat(n):""))},className:"float-right",buttonStyle:"solid",children:null===r||void 0===r?void 0:r.map((function(e){return(0,d.jsx)(a.ZP.Button,{value:e.value,children:(0,d.jsxs)("div",{className:"d-flex align-items-center",style:{gap:"10px"},children:[e.icon,e.title]})},e.value)}))})}}}]);